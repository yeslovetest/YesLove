!function(i){"use strict";i(document).ready(function(){var e,t=!1,a=!1,s=!1;function o(){i("<link/>",{rel:"stylesheet",href:Youzify.assets+"css/youzify-url-preview.min.css"}).appendTo("head"),i("<script/>",{rel:"text/javascript",src:Youzify.assets+"js/youzify-url-preview.min.js"}).appendTo("head")}function n(){var e,t,a,s,o,n=document.cookie.split(";"),f={};for(e=0;e<n.length;e++)a=(t=n[e]).indexOf("="),s=i.trim(unescape(t.slice(0,a))),o=unescape(t.slice(a+1)),0===s.indexOf("bp-")&&(f[s]=o);return encodeURIComponent(i.param(f))}i(".youzify-wall-form-show-all").on("click",function(e){i(".youzify-wall-form-show-all").fadeOut(function(){i(".youzify-wall-opts-item").fadeIn(),i(this).remove()})}),i(document).on("input click",".youzify-wall-textarea, .ac-input",function(){i(this).next(".youzify-load-emojis").attr("data-cursor",i(this).prop("selectionStart"))}),i(document).on("focus",".youzify-wall-textarea",function(){!1==t&&(i(this).closest("form").find(".youzify-lp-prepost").get(0)&&o(),t=!0)}),i(document).on("click",".youzify-edit-tool",function(){!1==t&&(i("#youzify-wall-form").find(".youzify-lp-prepost").get(0)&&o(),t=!0)}),i(document).on("click",".youzify-load-emojis",function(){i(this).closest("form"),i(this).find("i").attr("class","fas fa-spin fa-spinner"),i(this).addClass("loading"),i("<link/>",{rel:"stylesheet",href:Youzify.assets+"css/youzify-emojionearea.min.css"}).appendTo("head"),i("<script/>",{rel:"text/javascript",src:Youzify.assets+"js/youzify-emojionearea.min.js"}).appendTo("head")}),i(document).on("click",".youzify-wall-post",function(){var e,t,a=0,s=i(this),o=i(this).text(),f=s.closest("form#youzify-wall-form"),l={};i.each(f.serializeArray(),function(e,t){"_"!==t.name.substr(0,1)&&"whats-new"!==t.name.substr(0,9)&&(l[t.name]?i.isArray(l[t.name])?l[t.name].push(t.value):l[t.name]=[l[t.name],t.value]:l[t.name]=t.value)}),f.find("*").each(function(){(i.nodeName(this,"textarea")||i.nodeName(this,"input"))&&i(this).prop("disabled",!0)}),f.find(".youzify-wall-textarea").get(0).Youzify_emojioneArea&&f.find(".youzify-wall-textarea").data("Youzify_emojioneArea").disable(),s.addClass("loading"),s.prop("disabled",!0),f.addClass("submitted"),s.css("min-width",s.css("width")),s.html('<i class="fas fa-spinner fa-spin"></i>');var t="",y=f.find("#whats-new-post-in").val(),r=f.find("#whats-new").val(),d=i("#youzify ul.activity-list li").first(),c=d,u=null;return d.length&&(c.hasClass("load-newest")&&(c=d.next()),u=c.prop("class").match(/date-recorded-([0-9]+)/)),u&&(a=u[1]),y>0&&(t=f.find("#whats-new-post-object").val()),e=i.extend({action:"youzify_post_update",cookie:n(),_youzify_wpnonce_post_update:i("#_youzify_wpnonce_post_update").val(),content:r,object:t,item_id:y,since:a,_bp_as_nonce:i("#_bp_as_nonce").val()||""},l),i.post(ajaxurl,e,function(e){if(f.find("*").each(function(){(i.nodeName(this,"textarea")||i.nodeName(this,"input"))&&i(this).prop("disabled",!1)}),f.find(".youzify-wall-textarea").get(0).Youzify_emojioneArea&&f.find(".youzify-wall-textarea").data("Youzify_emojioneArea").enable(),!1==e.success)i.youzify_DialogMsg("error",e.data.error);else{if(s.html('<i class="fas fa-check"></i>').hide().fadeIn("slow"),f.find(".youzify-delete-attachment").trigger("click"),0===i("ul.activity-list").length&&(i("div.error").slideUp(100).remove(),i("#message").slideUp(100).remove(),i("div.activity").append('<ul id="activity-stream" class="activity-list item-list">')),d.hasClass("load-newest")&&d.remove(),i("#activity-stream").prepend(e),a||i("#activity-stream li:first").addClass("new-update just-posted"),i(e).get(0)&&i("body,html").animate({scrollTop:i("#"+i(e).attr("id")).offset().top-65+"px"},1e3),0!==i("#latest-update").length){var t=i("#activity-stream li.new-update .activity-content .activity-inner p").html(),n=i("#activity-stream li.new-update .activity-content .activity-header p a.view").attr("href"),y=i("#activity-stream li.new-update .activity-content .activity-inner p").text(),r="";""!==y&&(r=t+" "),r+='<a href="'+n+'" rel="nofollow">'+BP_DTheme.view+"</a>",i("#latest-update").slideUp(300,function(){i("#latest-update").html(r),i("#latest-update").slideDown(300)})}i("li.new-update").hide().slideDown(300),i("li.new-update").removeClass("new-update"),i("#whats-new").val(""),"activity_slideshow"==l.post_type&&i.youzify_sliders_init(),f.get(0).reset(),f.find(".youzify-wall-textarea").get(0).Youzify_emojioneArea&&f.find(".youzify-wall-textarea").get(0).Youzify_emojioneArea.setText(""),f.find('.bp-checkins input[type="hidden"]').val(""),f.find(".youzify-checkin-close-icon,.youzify-remove-map").trigger("click"),f.find(".youzify-tagged-user .youzify-tagusers-delete-user, .youzify-list-delete-item, .youzify-list-close-icon").trigger("click"),f.find("div.youzify-activity-privacy").find(".list div").first().trigger("click"),f.find("#whats-new-post-in").find("option").first().trigger("click"),window.hasOwnProperty("youzify_disable_niceselect")||f.find("#whats-new-post-in").niceSelect("update"),i("#whats-new-post-in").trigger("change"),f.find('.youzify-wall-options input:radio[name="post_type"]').first().trigger("change"),f.find(".youzify-lp-prepost .lp-button-cancel").trigger("click"),"activity_giphy"==l.post_type&&(f.find(".youzify-delete-giphy-item").trigger("click"),f.find(".youzify-giphy-submit-search").val("").trigger("click")),"activity_poll"==l.post_type&&(f.find(".youzify-wall-cf-input").val(""),f.find(".youzify-wall-poll-form .youzify-wall-cf-item:not(:nth-child(1)):not(:nth-child(2)) .youzify-wall-form-remove-item").trigger("click")),newest_activities="",activity_last_recorded=0}setTimeout(function(){s.html(o).fadeIn("slow")},1e3),f.find(".youzify-wall-post,.youzify-update-post").prop("disabled",!1).removeClass("loading"),"youzify-share-activity-wrapper"==f.parent().attr("id")&&i(".youzify-modal-close-icon").trigger("click")}),!1}),i(document).on("change",'input:radio[name="post_type"]',function(e){var t=i(this).closest("form"),s=i(this).val(),o=i(this).data("uploader");switch(i('input:radio[name="post_type"]').length>1?0==t.find('.youzify-wall-custom-form[data-post-type!="'+s+'"]').length?t.find('.youzify-wall-custom-form[data-post-type="'+s+'"]').fadeIn():t.find('.youzify-wall-custom-form[data-post-type!="'+s+'"]').fadeOut(1,function(){t.find('.youzify-wall-custom-form[data-post-type="'+s+'"]').fadeIn()}):t.find('.youzify-wall-custom-form[data-post-type="'+s+'"]').fadeIn(),s){case"activity_video":t.find(".youzify-upload-attachments").attr("accept","video/*");break;case"activity_audio":t.find(".youzify-upload-attachments").attr("accept","audio/*");break;case"activity_file":t.find(".youzify-upload-attachments").removeAttr("accept");break;case"activity_poll":a||(i("<script/>",{rel:"text/javascript",src:Youzify.assets+"js/youzify-polls.min.js"}).appendTo("head"),a=!0);break;default:t.find(".youzify-upload-attachments").attr("accept","image/*")}"on"==o?(void 0!==e.originalEvent&&"activity_quote"!=s&&"activity_link"!=s&&"youzify-edit-activity-wrapper"!=t.parent().attr("id")&&t.find(".youzify-wall-actions .youzify-wall-upload-btn").trigger("click"),t.find(".youzify-wall-actions .youzify-wall-upload-btn").fadeIn()):t.find(".youzify-wall-actions .youzify-wall-upload-btn").fadeOut(),t.find('.youzify-wall-custom-form[data-post-type="'+s+'"]').find('input[type="text"]')[0]&&t.find('.youzify-wall-custom-form[data-post-type="'+s+'"]').find('input[type="text"]')[0].focus(),t.find(".youzify-delete-attachment").trigger("click"),t.find(".youzify-attachment-item").remove()}),i('input:radio[name="post_type"]').first().trigger("change"),i(document).on("click",".youzify-wall-upload-btn",function(e){youzify_load_attachments||(i("<script/>",{rel:"text/javascript",src:Youzify.assets+"js/youzify-attachments.min.js"}).appendTo("head"),i("<link/>",{rel:"stylesheet",href:Youzify.assets+"css/youzify-attachments.min.css"}).appendTo("head"),youzify_load_attachments=!0),i(this).closest("form").find(".youzify-wall-attachments .youzify-upload-attachments").click(),e.preventDefault()}),i(document).on("click",".youzify-tag-users-tool",function(){var e=i(this).closest("form");if(e.find(".youzify-feeling-form,.youzify-checkin-form").fadeOut(),i(this).hasClass("loaded")){e.find(".youzify-tagusers-form").fadeToggle(),e.find(".youzify-tagusers-search-input").focus();return}var t=i(this),a=t.find("i"),s=a.attr("class");a.attr("class","fas fa-spinner fa-spin"),i.ajax({type:"POST",url:ajaxurl,dataType:"json",data:{action:"youzify_tag_users_get_user_friends"},success:function(o){t.addClass("loaded");var n=i("<div></div>").append(o.data);if("youzify-edit-activity-wrapper"==e.parent().attr("id")){var f=[];e.find('input[name="tagged_users[]"]').each(function(){n.find('.youzify-list-item[data-user-id="100"] ').fadeOut(),f.push(i(this).val())}),n.find(".youzify-list-item").each(function(e,t){-1!==jQuery.inArray(i(this).attr("data-user-id"),f)&&i(this).find(".youzify-wall-tag-user").hide()})}e.find(".youzify-tagusers-form").fadeIn(200,function(){a.attr("class",s),e.find(".youzify-tagusers-search-input").focus(),e.find(".youzify-wall-tagusers-list").html(n)})}})}),i(document).on("click",".youzify-checkin-tool",function(){var e=i(this).closest("form");e.find(".youzify-feeling-form,.youzify-tagusers-form").fadeOut(),e.find(".youzify-checkin-form").fadeToggle(),e.find(".youzify-checkin-search-input").focus(),s||"object"!=typeof google||"object"!=typeof google.maps||(i("<script/>",{rel:"text/javascript",src:Youzify.assets+"js/youzify-checkin.min.js"}).appendTo("head"),s=!0)}),i(document).on("keyup",".youzify-list-search-input",function(){var e=i(this).closest(".youzify-wall-list"),t=this.value.toLowerCase().trim();e.find(".youzify-wall-list-items .youzify-list-item").show().filter(function(){return -1==i(this).find(".youzify-item-title, .youzify-item-description").text().toLowerCase().trim().indexOf(t)}).hide()}),i(document).on("click",".youzify-user-mood-tool",function(){var e=i(this).closest("form");if(e.find(".youzify-tagusers-form,.youzify-checkin-form").fadeOut(),i(this).hasClass("loaded")){e.find(".youzify-feeling-form").fadeToggle(),e.find(".youzify-feeling-search-input").focus();return}e.find(".youzify-feeling-form").attr("data-placeholder",e.find(".youzify-feeling-search-input").attr("placeholder"));var t=i(this),a=t.find("i"),s=a.attr("class");a.attr("class","fas fa-spinner fa-spin"),i.ajax({type:"POST",url:ajaxurl,dataType:"json",data:{action:"youzify_feeling_activity_get_categories"},success:function(i){t.addClass("loaded"),e.find(".youzify-feeling-form").fadeIn(200,function(){a.attr("class",s),e.find(".youzify-feeling-search-input").focus(),e.find(".youzify-wall-feeling-list").html(i.data)})}})}),i(document).on("click",".youzify-feeling-item",function(e){e.preventDefault();var t=i(this),a=t.closest(".youzify-wall-feeling");if(i(this).parent().hasClass("youzify-list-category-items")){i.youzify_select_mood_emojis(a,t.attr("data-emoji"),t.attr("data-category-title"),t.find(".youzify-item-img").css("background-image"));return}a.find(".youzify-list-items-title").text(t.attr("data-category-title")),a.find('input[name="mood_type"]').val(t.attr("data-category")),a.find(".youzify-list-categories").fadeOut(),a.find(".youzify-feeling-close-icon").addClass("youzify-feeling-go-back"),a.find(".youzify-feeling-close-icon i").attr("class","far fa-arrow-alt-circle-left"),a.find('input[name="mood_search"]').val("").attr("placeholder",t.find(".youzify-item-description").text()),a.find(".youzify-list-search-icon i").attr("class",t.find(".youzify-item-icon i").attr("class"));var s=a.find('.youzify-list-category-items[data-category="'+i(this).attr("data-category")+'"]');1==s.length?s.fadeIn():a.find(".youzify-list-submit-button").fadeIn()}),i(document).on("click",".youzify-feeling-close-icon",function(){var e=i(this),t=e.closest(".youzify-wall-feeling");if(t.find(".youzify-feeling-submit-button").fadeOut(),t.find(".youzify-feeling-search-input").val(""),t.find(".youzify-feeling-search-input").attr("placeholder",t.find(".youzify-feeling-form").attr("data-placeholder")),t.find(".youzify-feeling-search-icon i").attr("class","fas fa-search"),e.hasClass("youzify-feeling-go-back")){e.find("i").attr("class","fas fa-times"),t.find(".youzify-list-categories, .youzify-list-item").fadeIn(),t.find(".youzify-list-category-items").fadeOut(),e.removeClass("youzify-feeling-go-back");return}e.closest(".youzify-feeling-form").fadeOut()}),i(document).on("click",".youzify-wall-feeling .youzify-list-edit-item",function(){var e=i(this),t=e.closest(".youzify-wall-feeling"),a=t.find(".youzify-list-selected-items");a.fadeOut(200,function(){t.find(".youzify-feeling-search-input").val(a.find(".youzify-item-title").text()),e.closest(".youzify-selected-item").fadeOut(200,function(){i(this).remove()}),t.find(".youzify-feeling-form").fadeIn(),t.removeClass("youzify-activity-feeling-selected")})}),i(document).on("click",".youzify-wall-feeling .youzify-list-delete-item",function(){var e=i(this),t=e.closest(".youzify-wall-feeling"),a=t.find(".youzify-list-selected-items");a.fadeOut(200,function(){a.find(".youzify-item-title").text(""),e.closest(".youzify-selected-item").fadeOut(200,function(){i(this).remove()}),t.find(".youzify-feeling-close-icon").trigger("click"),t.removeClass("youzify-activity-feeling-selected")})}),i(document).on("click",".youzify-feeling-submit-button",function(){var e=i(this).closest(".youzify-wall-feeling"),t=e.find(".youzify-feeling-search-input").val();""!=t.trim()&&i.youzify_select_mood_emojis(e,t,t)}),i(document).on("keypress",".youzify-feeling-search-input",function(e){if(13==e.keyCode){e.preventDefault();var t=i(this).next(".youzify-feeling-submit-button");"none"!=t.css("display")&&t.click()}}),i.youzify_select_mood_emojis=function(i,e,t,a){i.hasClass("youzify-activity-feeling-selected")&&i.find(".youzify-selected-item").remove(),i.addClass("youzify-activity-feeling-selected"),i.find(".youzify-feeling-form").fadeOut(0,function(){i.find(".youzify-feeling-selected-items").fadeIn()}),i.find(".youzify-list-selected-items").append('<div class="youzify-selected-item youzify-feeling-selected-item'+(null==a?" youzify-selected-item-no-image":"")+'">'+(null==a?"":"<div class='youzify-item-img' style='background-image: "+a+";'></div>")+'<div class="youzify-item-title">'+t+'</div><i class="fas fa-pencil-alt youzify-selected-item-tool youzify-list-edit-item"></i><i class="fas fa-trash-alt youzify-selected-item-tool youzify-list-delete-item"></i><input type="hidden" name="mood_value" value="'+e+'"></div>').fadeIn(),i.find(".youzify-feeling-search-input").val("")},i(document).on("click",".youzify-wall-tag-user",function(){var e=i(this);if(!e.hasClass("youzify-selected")){e.addClass("youzify-selected");var t=e.closest(".youzify-list-item");i(this).fadeOut(200,function(){var i="<div class=\"youzify-selected-item youzify-tagged-user\"><div class='youzify-item-img' style='background-image: "+t.find(".youzify-item-img").css("background-image")+';\'></div><div class="youzify-item-title">'+t.find(".youzify-item-title").text()+'</div><i class="fas fa-trash-alt youzify-selected-item-tool youzify-list-delete-item youzify-tagusers-delete-user" data-user-id="'+t.attr("data-user-id")+'"></i><input type="hidden" name="tagged_users[]" value="'+t.attr("data-user-id")+'"></div>';t.closest(".youzify-wall-tagusers").find(".youzify-tagged-users").append(i),e.closest(".youzify-wall-tagusers").find(".youzify-tagged-user").length;var a=e.closest(".youzify-wall-tagusers");1==a.find(".youzify-tagged-user").length&&a.find(".youzify-tagged-users").fadeIn()})}}),i(document).on("click",".youzify-list-close-icon.youzify-tagusers-close-icon",function(){i(this).closest(".youzify-tagusers-form").fadeOut()}),i(document).on("click",".youzify-tagusers-delete-user",function(){i(this).parent();var e=i(this).closest(".youzify-wall-tagusers"),t=i(this).closest(".youzify-tagged-users");e.find(".youzify-list-item[data-user-id="+i(this).attr("data-user-id")+"] .youzify-wall-tag-user").removeClass("youzify-selected").fadeIn(),i(this).parent().fadeOut(200,function(){i(this).remove(),0==t.find(".youzify-tagged-user").length&&t.fadeOut()})}),i(document).on("change","#whats-new-post-in",function(e){0!=i(this).val()?i(this).closest(".youzify-wall-actions").find("div.youzify-activity-privacy").fadeOut():i(this).closest(".youzify-wall-actions").find("div.youzify-activity-privacy").fadeIn()}),i(document).on("click",".youzify-send-comment",function(e){if(e.preventDefault(),!i(this).hasClass("loading")){var t,a,s,o,f,l,y,r,d,c,u,p,m=i(this);return p=m.closest(".activity"),m.addClass("loading"),u=m.find("i").attr("class"),m.find("i").attr("class","fas fa-spinner fa-spin"),s=(t=m.parents("form")).parent(),f=t.attr("id").split("-"),o=s.hasClass("activity-comments")?f[2]:(l=s.attr("id").split("-"))[1],a=p.find("#"+t.attr("id")+" textarea"),p.find("#"+t.attr("id")+" div.error").hide(),m.addClass("loading").prop("disabled",!0),a.addClass("loading").prop("disabled",!0),y={action:"new_activity_comment",cookie:n(),_wpnonce_new_activity_comment:i("#_wpnonce_new_activity_comment").val(),comment_id:o,form_id:f[2],post_type:"activity_comment",content:a.val()},(r=i("#_bp_as_nonce_"+o).val())&&(y["_bp_as_nonce_"+o]=r),i.post(ajaxurl,y,function(e){if(m.removeClass("loading"),a.removeClass("loading"),m.find("i").attr("class",u),e[0]+e[1]==="-1")t.append(i(e.substr(2,e.length)).hide().fadeIn(200));else{var s=t.parent();if(t.fadeOut(200,function(){0===s.children("ul").length&&(s.hasClass("activity-comments")?s.prepend("<ul></ul>"):s.append("<ul></ul>"));var a=i.trim(e);s.children("ul").append(i(a).hide().fadeIn(200)),t.children("textarea").val(""),s.parent().addClass("has-comments")}),p.find("#"+t.attr("id")+" textarea").val(""),d=Number(i("#activity-"+f[2]+" a.acomment-reply span").html())+1,i("#activity-"+f[2]+" a.acomment-reply span").html(d),c=s.closest(".activity-comments").find(".show-all a")){var o=c.text().match(/\((.*)\)/);o&&c.html(BP_DTheme.show_x_comments.replace("%d",Number(o[1])+1))}}i(m).prop("disabled",!1),i(a).prop("disabled",!1)}),!1}}),i(document).on("keypress",".ac-form textarea",function(e){13!=e.which||e.shiftKey||(e.preventDefault(),i(this).closest("form").find(".youzify-send-comment").click())}),i.youzify_isPostType=function(i,e){return e==i.find('input:radio[name="post_type"]:checked').val()},i(document).on("click",".share-activity",function(t){if(t.preventDefault(),!i(".share-activity.loading")[0]){var a,s=i(this),o=s.parents("li").attr("id").split("-")[1],n=(s.attr("data-activity-type"),!0);if(!s.hasClass("loading")){s.addClass("loading"),e=s,a=i("#youzify-edit-activity-wrapper");var f={action:"youzify_get_share_activity_form",youzify_share_activity_nonce:Youzify.security_nonce,activity_id:o};i.post(Youzify.ajax_url,f,function(t){if(!1==t.success){e.remove(),i.youzify_DialogMsg("error",t.error);return}var a=i(t.data.form);i("body").append(a.hide());var o=i(t.data.preview);o.insertAfter(a.find("textarea#whats-new")),jQuery.isFunction(i.fn.niceSelect)&&a.find('select:not([multiple="multiple"])').niceSelect(),o.height()>150&&(o.find(".youzify-shared-wrapper-container").addClass("youzify-collapsed-preview"),a.find(".youzify-shared-wrapper").append(t.data.show_all)),a.find("form").append('<input type="hidden" value="activity_share" name="post_type" />'),a.find("form").append('<input type="hidden" value="'+t.data.activity_id+'" name="secondary_item_id" />'),a.find(".youzify-wall-options").remove(),"on"==t.posts_emojis&&(n=!1,jQuery().Youzify_emojioneArea?a.find(".youzify-wall-textarea").Youzify_emojioneArea({pickerPosition:"bottom",autocomplete:!0,saveEmojisAs:"image",events:{ready:function(){this.editor.textcomplete([{id:"youzify_mentions",match:/\B@([\-\d\w]*)$/,search:function(e,t){var a=bp.mentions.users;t(i.map(a,function(i){return 0===i.ID.indexOf(e)||0===i.name.indexOf(e)?i:null}))},template:function(i){return'<img src="'+i.image+'" /><span class="username">@'+i.ID+"</span><small>"+i.name+"</small>"},replace:function(i){return"@"+i.ID+"&nbsp;"},cache:!0,index:1}])}}}):(i("<script/>",{rel:"text/javascript",src:Youzify.assets+"js/youzify-emojionearea.min.js"}).appendTo("head"),i("<link/>",{rel:"stylesheet",href:Youzify.assets+"css/youzify-emojionearea.min.css"}).appendTo("head"))),a.find(".youzify-wall-upload-btn").remove();var f=setInterval(function(){(!0==n||!1==n&&a.find(".youzify-emojionearea").get(0))&&(clearInterval(f),s.attr("data-loaded","true"),s.removeClass("loading"),i.youzify_show_modal(a))},100)}).fail(function(e,t,a){return s.removeClass("loading"),i.youzify_DialogMsg("error",Youzify.unknown_error),!1})}}}),i(document).on("click",".youzify-show-all-less div",function(){var e=i(this).parent();e.hasClass("active")?(e.removeClass("active"),e.prev(".youzify-shared-wrapper-container").addClass("youzify-collapsed-preview")):(e.addClass("active"),e.prev(".youzify-shared-wrapper-container").removeClass("youzify-collapsed-preview"))})})}(jQuery);