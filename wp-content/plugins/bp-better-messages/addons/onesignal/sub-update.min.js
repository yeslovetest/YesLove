var OneSignalUpdate=function(){var n;return function(){var e=parseInt(Better_Messages.user_id);BetterMessages.getApi().then((function(t){BetterMessages.getSetting("oneSignal").then((function(i){let s=!1;OneSignal.getUserId().then((function(a){a&&(i?(i.user_id!=e&&(s=!0),i.subscription_id!=a&&(s=!0)):s=!0,s&&(n&&clearTimeout(n),n=setTimeout((function(){t.post("oneSignal/updateSubscription",{subscription_id:a}).then((function(n){BetterMessages.updateSetting("oneSignal",{user_id:e,subscription_id:a}),OneSignal.setExternalUserId(e)})).catch((function(n){console.error(n)}))}),3e3)))}))}))}))}}();"undefined"!=typeof OneSignal&&OneSignal.push((function(){OneSignal.isPushNotificationsEnabled().then((function(n){n&&OneSignalUpdate()})),OneSignal.on("subscriptionChange",(function(n){n&&OneSignalUpdate()}))}));
